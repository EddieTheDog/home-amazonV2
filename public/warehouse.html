<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Warehouse - Laptop</title>
<style>
body { font-family: Arial; margin: 20px; }
button { padding: 5px 10px; margin-right: 5px; margin-top: 5px; }
#status { font-weight: bold; margin-top: 10px; }
#scans { background:#f5f5f5; padding:10px; margin-top:20px; max-height:400px; overflow-y:auto; white-space:pre-wrap;}
</style>
</head>
<body>
<h1>Warehouse - Laptop</h1>

<label>Employee Name: <input type="text" id="employee"></label>
<label>Location: <input type="text" id="location"></label>
<button id="generateSession">Generate Session</button>
<button id="startScanning" disabled>Start Scanning</button>
<button id="endSession" disabled>End Session</button>

<div id="status">No active session</div>
<div id="scans">Waiting for scans...</div>

<script>
let sessionKey = null;
let deviceName = null;
let sessionActive = false;
let scanningActive = false;

document.getElementById('generateSession').addEventListener('click', async ()=>{
    const employee = document.getElementById('employee').value.trim();
    const location = document.getElementById('location').value.trim();
    if(!employee || !location) return alert("Fill all fields");

    const res = await fetch('/api/session/start',{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({employee,location})
    });
    const data = await res.json();
    if(res.ok){
        sessionKey = data.sessionKey;
        sessionActive = true;
        document.getElementById('status').textContent = `Session ${sessionKey} started. Waiting for device...`;
        document.getElementById('endSession').disabled = false;
        alert(`Session key: ${sessionKey}. Give this to the device to connect.`);
    }
});

async function checkDeviceQueue(){
    if(!sessionActive) return;
    const res = await fetch(`/api/session/join`,{method:'GET'});
    // For simplicity, this will be simulated later
}
</script>
</body>
</html>
